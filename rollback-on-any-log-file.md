**カレントログファイル以外のログファイル（.4BL）からデータを復元したい**

データの書き込みが不完全な場合，たとえばデータファイルの書き込み中にアプリケーションが終了した場合，再起動後に『データファイルが壊れています』というメッセージが表示され，ユーザーは『最新のバックアップからデータを復元し，最新のログを統合する』ように勧められます。（[自動的に実行されるよう設定](http://doc.4d.com/4Dv14/4D/14.3/Configuration-of-backup-settings.300-1705434.ja.html)することもできます。）その後，データベースの管理者はカレントログファイルから統合されたログを確認し，必要であれば，[ロールバック](http://doc.4d.com/4Dv14/4D/14.3/Rollback-page.300-1705423.ja.html)を実行することにより，任意のポイントまで『データベースを戻す』ことができます。たとえば，望ましくないオペレーションを取り消したい場合，バックアップからの復元とカレントログファイルの統合が完了した後，問題のあるオペレーションの直前までロールバックすることができます。

MSCの画面でロールバックができるのは，カレントログファイルだけです。最新のバックアップ以外のバックアップファイルも選択することができますが，その場合，『ロールバック』ボタンはグレーアウトされ，クリックできないようになっています。カレントログファイル（.journal）以外のログファイル（.4BL）からロールバックすることは，いまのところ，**MSCではサポートされていない**からです。

それでも，いくつかの操作を組み合わせることにより，カレントログファイル以外のログファイル（.4BL）からデータを復元することができます。結果的に，下記のことが実現できます。

* 任意のログファイルをカレントログファイルにする
* 任意のログファイルよりオペレーションを取り消す

この記事では，マニュアルロールバックの方法を説明しています。

1. カレントログファイル（.journal）
* 『ファイル/復元』メニューまたはMSCより，新規フォルダー内に最新のバックアップ（.4BK）を復元します。
 * データファイル（.4DD）以外は削除します。
* それまで運用していたデータベースのフォルダーより，下記のファイルとフォルダーを上述のバックアップ復元フォルダーにコピーします。
 * ```Preferences```フォルダー（```backup.xml```が含まれている）
 * ストラクチャファイル（.4DB）
 * 最新のバックアップファイル（.4BKおよび.4BL）
 * カレントログファイル（.journal）
* 運用していたデータベースフォルダーの名称を変更します。（例：```old```のように適当な接頭辞を付ける）
* バックアップ復元フォルダーの名称をそれまで運用していたデータベースフォルダーの元の名称に変更します。
* データベースを起動します。

---
**原文**: [Rollback on any log file](http://taow.4d.com/Rollback-on-any-log-file/tips.56849281.en.html)
